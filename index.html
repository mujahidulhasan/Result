<!DOCTYPE html>
<html lang="en" class="dark" data-theme="dark">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BTEB Result Hub | Glassmorphism Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.2/dist/full.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    
    <style>
        /* Import Fonts */
        @import url("https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&family=Ubuntu:wght@400;500;700&display=swap");
        .font-ubuntu { font-family: 'Ubuntu', sans-serif; }
        .font-lato { font-family: 'Lato', sans-serif; }
        
        /* Red Asterisk Utility */
        .required-star {
            color: #ef4444; /* Tailwind red-500 */
            font-weight: bold;
        }

        /* --- CORE GLASSMORHPISM STYLES & VARIABLES --- */
        /* Define CSS variables for clean theme switching */
        html[data-theme="dark"] {
            --glass-card-bg-color: rgba(255, 255, 255, 0.05);
            --glass-card-border-color: rgba(255, 255, 255, 0.1);
        }
        html[data-theme="light"] {
            --glass-card-bg-color: rgba(255, 255, 240, 0.7); /* Slightly warmer off-white in light mode */
            --glass-card-border-color: rgba(0, 0, 0, 0.15);
        }

        .glass-card {
            /* Base Glass Properties */
            background-color: var(--glass-card-bg-color); 
            border: 1px solid var(--glass-card-border-color);
            backdrop-filter: blur(10px); 
            -webkit-backdrop-filter: blur(10px); /* Webkit Prefix for better support */
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }
        
        /* Header/Nav: Sticky and Translucent */
        header nav {
            position: sticky;
            top: 0;
            z-index: 40;
            border-bottom: 1px solid transparent;
        }

        /* --- DARK MODE --- */
        html[data-theme="dark"] body {
             background-color: #1e293b; 
             background-image: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); 
        }
        html[data-theme="dark"] header nav {
            background-color: rgba(15, 23, 42, 0.8) !important; 
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-bottom-color: rgba(255, 255, 255, 0.1);
        }

        /* --- LIGHT MODE --- */
        html[data-theme="light"] body {
             background-color: #f8fafc;
             background-image: linear-gradient(135deg, #e2e8f0 0%, #ffffff 100%);
             color: #1e293b;
        }
        html[data-theme="light"] header nav {
            background-color: rgba(255, 255, 255, 0.9) !important;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-bottom-color: rgba(0, 0, 0, 0.1);
        }
        
        /* Text Color Adjustments for Light Mode */
        html[data-theme="light"] .dark\:text-gray-900,
        html[data-theme="light"] .dark\:text-white {
            color: #1e293b !important;
        }
        html[data-theme="light"] .dark\:text-gray-200,
        html[data-theme="light"] .dark\:text-gray-400 {
             color: #475569 !important;
        }

        /* Main container must be transparent to see the body background and the blur effect */
        .main-container {
             background-color: transparent !important;
             box-shadow: none !important;
        }

        /* --- FORM ELEMENT SPECIFIC STYLES --- */
        #roll-number:focus,
        select.select:focus,
        .custom-dropdown-header:focus {
            outline: 2px solid #5d93ff; 
            outline-offset: 2px;
            box-shadow: 0 0 0 2px #5d93ff;
        }

        /* Base input styling for better glass integration in dark mode */
        html[data-theme="dark"] .input, 
        html[data-theme="dark"] .select, 
        html[data-theme="dark"] .custom-dropdown-header {
             background-color: rgba(255, 255, 255, 0.1) !important;
             border-color: rgba(255, 255, 255, 0.2) !important;
             color: white !important;
        }
        /* Base input styling for better glass integration in light mode */
        html[data-theme="light"] .input,
        html[data-theme="light"] .select, 
        html[data-theme="light"] .custom-dropdown-header {
             background-color: rgba(0, 0, 0, 0.05) !important;
             border-color: rgba(0, 0, 0, 0.1) !important;
             color: black !important;
        }
        
        /* --- LAYOUT FIXES --- */
        .max-w-3xl.mx-auto.space-y-8 {
            max-width: 100%; 
            padding-left: 1rem;
            padding-right: 1rem;
        }
        @media (min-width: 1024px) {
            .max-w-3xl.mx-auto.space-y-8 {
                max-width: 48rem;
                padding-left: 0;
                padding-right: 0;
            }
        }
        .main-nav-links .active {
            color: #1d4ed8; 
            text-decoration: underline;
            text-underline-offset: 8px;
        }
        .main-nav-links .active.dark\:text-blue-400 {
             color: #60a5fa;
        }
        html[data-theme="light"] .main-nav-links .active {
             color: #1d4ed8 !important;
        }
        /* Custom Dropdown Styles (Unchanged) */
        .custom-dropdown-container { position: relative; width: 100%; }
        .custom-dropdown-header {
            display: flex; justify-content: space-between; align-items: center; height: 3rem; min-height: 3rem;
            padding-inline-start: 1rem; padding-inline-end: 1rem; border-radius: 0.5rem; cursor: pointer;
            font-size: 0.875rem; line-height: 1.25rem;
        }
        .card {
            position: absolute; z-index: 10; top: 100%; margin-top: 8px; width: 100%; user-select: none;
            border-radius: 10px; padding: 10px; display: flex; flex-direction: column; gap: 8px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1); display: none;
        }
        html[data-theme="dark"] .card {
            background-color: rgba(31, 41, 55, 0.95); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1);
        }
        html[data-theme="light"] .card {
            background-color: rgba(255, 255, 255, 0.95); border: 1px solid rgba(0, 0, 0, 0.1);
        }
        .card.open { display: flex; }
        .card .list .element label input[type="radio"] { display: none; }
        .card .list { list-style-type: none; display: flex; flex-direction: column; gap: 4px; padding: 0px; }
        .card .list .element > label {
            display: flex; align-items: center; color: #a6adbb; gap: 10px; transition: all 0.3s ease-out;
            padding: 6px; border-radius: 6px; cursor: pointer; font-weight: 600;
        }
        html[data-theme="light"] .card .list .element > label { color: #4b5563; }
        .card .list .element label svg {
            width: 19px; height: 19px; transition: all 0.3s ease-out; stroke: currentColor;
        }
        .card .list .element label:has(input[type="radio"]:checked),
        .card .list .element label:hover { background-color: #5d93ff; color: white; }
        .card .list .element label:has(input[type="radio"]:checked) svg,
        .card .list .element label:hover svg { stroke: white; }
        .card .separator { border-top: 1.5px solid rgba(255, 255, 255, 0.1); }
        html[data-theme="light"] .card .separator { border-top: 1.5px solid rgba(0, 0, 0, 0.1); }


        /* --- NEW CUSTOM RESULT POPUP STYLES (from your new code) --- */
        /* Reset font for consistency, using existing font */
        .popup * {
            font-family: 'Ubuntu', sans-serif;
            box-sizing: border-box;
        }

        /* Base popup container styling */
        #popup-container {
            max-width: 420px;
            padding: 0;
            margin: 0 auto;
            width: 90%;
        }
        .popup {
            position: relative;
            backdrop-filter: blur(18px) saturate(160%);
            -webkit-backdrop-filter: blur(18px) saturate(160%);
            background-color: rgba(17, 25, 40, 0.55);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.45);
            padding: 22px;
            transition: all 0.3s ease;
            color: #fff; /* Base text color for dark glass theme */
        }
        html[data-theme="light"] .popup {
            background-color: rgba(255, 255, 255, 0.85);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            color: #1e293b; /* Base text color for light glass theme */
        }


        /* Close button */
        .close-btn {
            position: absolute;
            top: 10px;
            right: 14px;
            background: transparent;
            border: none;
            font-size: 1.4rem;
            cursor: pointer;
            transition: color 0.3s;
            color: #fff; /* Dark mode color */
        }
        html[data-theme="light"] .close-btn {
            color: #1e293b; /* Light mode color */
        }
        .close-btn:hover {
            color: #ff4c4c;
        }

        /* Screenshot icon button */
        .screenshot-btn {
            position: absolute;
            top: 10px;
            left: 14px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            color: #fff;
            font-size: 1.1rem;
            width: 34px;
            height: 34px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        html[data-theme="light"] .screenshot-btn {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
            color: #1e293b;
        }
        .screenshot-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        html[data-theme="light"] .screenshot-btn:hover {
            background: rgba(0, 0, 0, 0.15);
        }


        .popup-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .popup-header h2 {
            margin: 0;
            font-size: 1.4rem;
        }

        .popup-header p {
            margin: 5px 0;
            font-size: 0.95rem;
            color: #ccc;
        }
        html[data-theme="light"] .popup-header p {
            color: #475569;
        }

        /* ===== RESULT CARD ===== */
        .result-card {
            margin: 12px 0;
        }

        .semester-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .semester-header span {
            flex: 1;
            text-align: left;
            font-weight: bold;
        }

        .semester-header .status-passed {
            flex: 1;
            text-align: center;
            color: #00ff99;
            font-weight: 600;
        }
        .semester-header .status-referred {
            flex: 1;
            text-align: center;
            color: #ff4c4c;
            font-weight: 600;
        }


        .semester-header .date {
            flex: 1;
            text-align: right;
            font-size: 0.9rem;
            color: #ccc;
        }
        html[data-theme="light"] .semester-header .date {
            color: #475569;
        }

        /* ===== GRADE GLOW & COLORS ===== */
        .cgpa {
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            padding: 10px 0;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }

        .cgpa::before {
            content: "";
            position: absolute;
            top: 0;
            left: -150%;
            width: 150%;
            height: 100%;
            background: linear-gradient(
              120deg,
              rgba(255, 255, 255, 0) 0%,
              rgba(255, 255, 255, 0.45) 50%,
              rgba(255, 255, 255, 0) 100%
            );
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -150%; }
            50% { left: 150%; }
            100% { left: 150%; }
        }

        .grade-aplus {
            background: linear-gradient(135deg, #ffd700, #ffea8a);
            color: #5a4200;
            box-shadow: 0 0 20px #ffd700a8;
        }

        .grade-a {
            background: linear-gradient(135deg, #00ff88, #7fffbd);
            color: #003a1f;
            box-shadow: 0 0 20px #00ff88a8;
        }

        .grade-aminus {
            background: linear-gradient(135deg, #ffe96a, #fff6b1);
            color: #553e00;
            box-shadow: 0 0 20px #ffe96aa8;
        }

        /* New: Color for 'Ref' status in the GPA section */
        .grade-ref {
            background: linear-gradient(135deg, #ef4444, #fca5a5); /* Red-500 to Red-300 */
            color: #450a0a; /* Red-900 */
            box-shadow: 0 0 20px #ef4444a8;
        }

        /* Mobile */
        @media (max-width: 480px) {
            .popup {
              padding: 16px;
            }
            .popup-header h2 {
              font-size: 1.2rem;
            }
            .semester-header span,
            .semester-header .status,
            .semester-header .date {
              font-size: 0.9rem;
            }
            .cgpa {
              font-size: 1rem;
            }
        }
    </style>

    <meta name="author" content="Modasser Hasan">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="BTEB Result Hub">
    <meta property="og:locale" content="en_US">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body class="min-h-screen">
    
    <div class="Toastify"></div>
    
    <div class="max-w-[1050px] mx-auto font-ubuntu main-container" data-theme="dark" id="main-content-wrapper">
        
        <div class="drawer">
            <input id="my-drawer" type="checkbox" class="drawer-toggle">
            
            <div class="drawer-content">
                
                <header>
                    <nav class="border-gray-200 dark:border-gray-700">
                        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
                            <div>
                                <a title="Home Page" class="flex items-center space-x-3 self-center text-xl sm:text-2xl font-semibold whitespace-nowrap dark:text-white hover:underline underline-offset-8" href="/">
                                    BTEB Result Hub
                                </a>
                            </div>
                            
                            <div class="items-center justify-between flex w-auto">
                                <ul class="main-nav-links font-medium rounded-lg space-x-8 mt-0 border-0 hidden lg:flex">
                                    <li><a class="block py-2 px-3 md:p-0 text-gray-900 rounded hover:text-blue-700 dark:hover:text-blue-400 dark:text-white active:scale-[.95] transition-[transform] duration-200 active" href="/results">Individual Results</a></li>
                                    <li><a class="block py-2 px-3 md:p-0 text-gray-900 rounded hover:text-blue-700 dark:hover:text-blue-400 dark:text-white active:scale-[.95] transition-[transform] duration-200" href="/institute-results">Institute Results</a></li>
                                    <li><a class="block py-2 px-3 md:p-0 text-gray-900 rounded hover:text-blue-700 dark:hover:text-blue-400 dark:text-white active:scale-[.95] transition-[transform] duration-200" href="/group-results">Group Results</a></li>
                                    <li><a class="block py-2 px-3 md:p-0 text-gray-900 rounded hover:text-blue-700 dark:hover:text-blue-400 dark:text-white active:scale-[.95] transition-[transform] duration-200" href="/cgpa-calculator">CGPA Calculator</a></li>
                                </ul>
                            </div>
                            
                            <div class="flex gap-5 items-center">
                                <button onclick="toggleTheme()" title="Toggle Theme" id="theme-toggle" class="text-white">
                                    <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" style="cursor:pointer;transform:rotate(40deg);color:white">
                                        <mask id="circle-mask-0"><rect x="0" y="0" width="100%" height="100%" fill="white"></rect><circle cx="50%" cy="23%" r="9" fill="black"></circle></mask>
                                        <circle cx="12" cy="12" fill="white" style="r:9px" mask="url(#circle-mask-0)"></circle>
                                    </svg>
                                    <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="cursor:pointer;display:none;">
                                        <circle cx="12" cy="12" r="5" stroke="#000"></circle>
                                        <g stroke="#000">
                                            <line x1="12" y1="1" x2="12" y2="3"></line>
                                            <line x1="12" y1="21" x2="12" y2="23"></line>
                                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                            <line x1="1" y1="12" x2="3" y2="12"></line>
                                            <line x1="21" y1="12" x2="23" y2="12"></line>
                                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                        </g>
                                    </svg>
                                </button>
                                
                                <label for="my-drawer" class="btn text-2xl py-3 lg:hidden" title="More Menu">
                                    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 0 0 0-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0 0 14.4 7z"></path></svg>
                                </label>
                            </div>
                        </div>
                    </nav>
                </header>
                <main class="my-4">
                    <dialog id="result_modal" class="modal">
                        <div class="modal-box p-0 bg-transparent shadow-none" id="popup-container">
                            </div>
                        <form method="dialog" class="modal-backdrop">
                            <button>close</button>
                        </form>
                    </dialog>
                    <div class="p-4 sm:p-6 lg:p-8">
                        <div class="max-w-xl sm:max-w-lg mx-auto p-5 sm:p-8 rounded-2xl glass-card form-card shadow-lg">
                            <h1 class="text-2xl font-bold dark:text-white text-gray-900 mb-1">Individual Result Check</h1>
                            <p class="dark:text-gray-200 text-gray-700 mb-6">Check your Results in One Click!</p>
                            
                            <div class="space-y-4">
                                <div class="custom-dropdown-container">
                                    <label class="block mb-1 text-sm font-medium dark:text-gray-400 text-gray-700">
                                        Exam <span class="required-star">*</span>
                                    </label>
                                    
                                    <div class="custom-dropdown-header" onclick="toggleDropdown(this)">
                                        <span id="selected-exam">Diploma in Engineering</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-gray-400">
                                            <path d="m6 9 6 6 6-6"/>
                                        </svg>
                                    </div>
                                    
                                    <div class="card" id="exam-dropdown-menu">
                                        <ul class="list">
                                            <li class="element">
                                                <label for="exam-eng" onclick="selectOption('exam-eng', 'Diploma in Engineering', 'selected-exam')">
                                                    <input type="radio" id="exam-eng" name="exam-filed" value="DIPLOMA IN ENGINEERING" checked />
                                                    <svg class="lucide lucide-book-open" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" fill="none" viewBox="0 0 24 24" height="20" width="20" xmlns="http://www.w3.org/2000/svg" stroke="#7e8590"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                                                    Diploma in Engineering
                                                </label>
                                            </li>
                                            <div class="separator"></div>
                                            <li class="element">
                                                <label for="exam-textile" onclick="selectOption('exam-textile', 'Diploma in Textile', 'selected-exam')">
                                                    <input type="radio" id="exam-textile" name="exam-filed" value="DIPLOMA IN TEXTILE" />
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#7e8590" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-factory">
                                                         <path d="M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-6 4-6-4-6 4V4a2 2 0 0 1 2-2h4"/>
                                                         <path d="M12 2v6"/>
                                                         <path d="M12 10v6"/>
                                                         <path d="M16 8v6"/>
                                                         <path d="M16 12v6"/>
                                                     </svg>
                                                    Diploma in Textile
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="custom-dropdown-container">
                                    <label class="block mb-1 text-sm font-medium dark:text-gray-400 text-gray-700">
                                        Regulation <span class="required-star">*</span>
                                    </label>
                                    
                                    <div class="custom-dropdown-header" onclick="toggleDropdown(this)">
                                        <span id="selected-regulation">2022</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-gray-400">
                                            <path d="m6 9 6 6 6-6"/>
                                        </svg>
                                    </div>
                                    
                                    <div class="card" id="regulation-dropdown-menu">
                                        <ul class="list">
                                            <li class="element">
                                                <label for="reg-2022" onclick="selectOption('reg-2022', '2022', 'selected-regulation')">
                                                    <input type="radio" id="reg-2022" name="regulation-field" value="2022" checked />
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#7e8590" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-clock"><path d="M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h6.5"/><path d="M16 2v4"/><path d="M8 2v4"/><path d="M3 10h8"/><circle cx="17" cy="17" r="5"/><path d="M17 14v3h3"/></svg>
                                                    2022
                                                </label>
                                            </li>
                                            <div class="separator"></div>
                                            <li class="element">
                                                <label for="reg-2016" onclick="selectOption('reg-2016', '2016', 'selected-regulation')">
                                                    <input type="radio" id="reg-2016" name="regulation-field" value="2016" />
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#7e8590" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-off"><path d="M4.2 4.2A2 2 0 0 0 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 1.8-1.2"/><path d="M8 2v4"/><path d="M16 2v2"/><path d="M3 10h11"/><path d="m2 2 20 20"/></svg>
                                                    2016
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div>
                                    <label for="roll-number" class="block mb-1 text-sm font-medium dark:text-gray-400 text-gray-700">
                                        Roll Number <span class="required-star">*</span>
                                    </label>
                                    <input type="text" id="roll-number" value="" class="input input-bordered w-full" placeholder="Enter your 6 digit roll number">
                                </div>
                                
                                <button onclick="getResults()" class="btn btn-info w-full text-white bg-blue-600 hover:bg-blue-700 border-none">Get Result</button>
                            </div>
                        </div>

                        
                        <div class="max-w-xl sm:max-w-lg mx-auto my-8">
                             <img 
                                src="active-student-engagement-in-a-digital-classroom-art-illustration-creative-learning-environment-dynamic-perspective-educational-concept-free-png.png" 
                                alt="Active Student Engagement Illustration" 
                                class="block w-full h-auto rounded-lg"
                            >
                        </div>

                        <div class="max-w-3xl mx-auto space-y-8">
                            
                            <div class="p-6 rounded-2xl shadow-md bg-transparent">
                                <h2 class="text-xl font-semibold dark:text-white text-gray-900 mb-3">Individual Result (Explained)</h2>
                                <p class="dark:text-gray-200 text-gray-700">
                                    Elevate the experience of result viewing for diploma students with your Individual Result link. No more navigating through complex official websites or long wait times! Enter your roll number, and our website will swiftly fetch the official PDF document to instantly present your result. Seamlessly check your grades and performance across different semesters, allowing you to track your progress with ease. With the option to copy the result link, sharing your achievements has never been simpler.
                                </p>
                            </div>

                            <div class="p-6 rounded-2xl shadow-md bg-transparent">
                                <h2 class="text-xl font-semibold dark:text-white text-gray-900 mb-3">How to Check Your Result</h2>
                                <p class="mb-4 dark:text-gray-200 text-gray-700">
                                    Enter your Roll number in the form, Select your Exam and Regulation, and click on "Get Result" to see your individual results.
                                </p>

                                <h3 class="text-lg font-medium dark:text-white text-gray-900 mb-2">Supported Exam Results</h3>
                                <ul class="list-disc list-inside space-y-1 dark:text-gray-200 text-gray-700">
                                    <li>Diploma in Engineering</li>
                                    <li>Diploma in Textile</li>
                                </ul>
                            </div>
                            
                            <div class="p-6 rounded-2xl shadow-md bg-transparent">
                                <h2 class="text-xl font-semibold dark:text-white text-gray-900 mb-3">Multiple Semester Results (Explained)</h2>
                                <p class="dark:text-gray-200 text-gray-700">
                                    A single semester might have several results, each with a publication date listed at the top. However, only the most recent result is considered final for that semester. Previous results are simply historical records. Therefore, don't be confused if past results mislead you; look for the final result with the latest publication date.
                                </p>
                            </div>
                        </div>

                    </div>
                </main>
                <footer class="p-10 pb-3 glass-card">
                    <div class="flex flex-col items-center md:flex-row justify-between gap-5 dark:text-white text-gray-900">
                        <div class="text-center md:text-left">
                            <h1 class="text-2xl font-lato font-semibold">BTEB Result Hub</h1>
                            <p class="dark:text-gray-400 text-gray-700">Solution of your BTEB Results!</p>
                        </div>
                        
                        <ul class="flex flex-wrap justify-center items-center mb-6 text-sm font-medium text-gray-500 sm:mb-0 dark:text-gray-400">
                            <li><a class="hover:underline underline-offset-2 me-4 md:me-6" href="/results">Individual Result</a></li>
                            <li><a class="hover:underline underline-offset-2 me-4 md:me-6" href="/institute-results">Institute Result</a></li>
                            <li><a class="hover:underline underline-offset-2 me-4 md:me-6" href="/booklists">Booklists</a></li>
                            <li><a class="hover:underline underline-offset-2 me-4 md:me-6" href="/about">About</a></li>
                        </ul>
                    </div>
                    
                    <div class="flex justify-center gap-5 text-xl border-y dark:border-gray-700 border-gray-400 my-5 py-5 dark:text-white text-gray-900">
                        <a href="https://www.facebook.com/mujahidulhasan2" target="_blank" title="Facebook">
                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"></path></svg>
                        </a>
                        <a href="mailto:mujahidulhasan2@gmail.com" title="Email">
                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-80.8 108.9L531.7 514.4c-7.8 6.1-18.7 6.1-26.5 0L189.6 268.9A7.2 7.2 0 0 1 194 256h648.8a7.2 7.2 0 0 1 4.4 12.9z"></path></svg>
                        </a>
                        <a href="https://github.com/mujahidulhasan" target="_blank" title="GitHub">
                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8"></path></svg>
                        </a>
                    </div>
                    
                    <div>
                           <p class="block text-xs sm:text-sm text-gray-500 text-center dark:text-gray-400">© 2024 <a href="/" class="hover:underline underline-offset-2">BTEBResultHub</a>. All Rights Reserved.</p>
                    </div>
                </footer>
                </div>
            
            <div class="drawer-side z-50">
                <label for="my-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
                <div class="w-72 sm:w-80 min-h-full max-h-full bg-base-200 text-base-content overflow-y-auto dark:bg-slate-900/90" style="backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);">
                    
                    <div class="mb-2 px-6 py-10 bg-slate-200 dark:bg-slate-900">
                        <h1 class="text-2xl font-lato font-bold">BTEB Result Hub</h1>
                        <p class="italic text-sm sm:text-base">Where BTEB Results come to Life!</p>
                    </div>
                    
                    <ul class="menu [&_a]:btn [&_a]:gap-3 [&_a]:justify-start [&_a]:py-2 [&_a]:text-base sm:[&_a]:text-lg">
                        <li><a href="/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12.97 2.59a1.5 1.5 0 0 0-1.94 0l-7.5 6.363A1.5 1.5 0 0 0 3 10.097V19.5A1.5 1.5 0 0 0 4.5 21h4.75a.75.75 0 0 0 .75-.75V14h4v6.25c0 .414.336.75.75.75h4.75a1.5 1.5 0 0 0 1.5-1.5v-9.403a1.5 1.5 0 0 0-.53-1.144l-7.5-6.363Z"></path></svg> Home</a></li>
                        <li><a href="/results"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z"></path></svg>Individual Result</a></li>
                        <li><a href="/institute-results"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21 10h-2V4h1V2H4v2h1v6H3a1 1 0 0 0-1 1v9h20v-9a1 1 0 0 0-1-1zm-7 8v-4h-4v4H7V4h10v14h-3z"></path><path d="M9 6h2v2H9zm4 0h2v2h-2zm-4 4h2v2H9zm4 0h2v2h-2z"></path></svg>Institute Result</a></li>
                        <li><a href="/group-results"><svg stroke="currentColor" fill="currentColor" stroke-width="0" version="1.2" baseProfile="tiny" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 14c1.381 0 2.631-.56 3.536-1.465.904-.904 1.464-2.154 1.464-3.535s-.56-2.631-1.464-3.535c-.905-.905-2.155-1.465-3.536-1.465s-2.631.56-3.536 1.465c-.904.904-1.464 2.154-1.464 3.535s.56 2.631 1.464 3.535c.905.905 2.155 1.465 3.536 1.465zM20 15c.69 0 1.315-.279 1.768-.731.453-.452.732-1.077.732-1.769 0-.69-.279-1.315-.732-1.768-.453-.453-1.078-.732-1.768-.732-.691 0-1.316.279-1.769.732-.452.453-.731 1.078-.731 1.768 0 .691.279 1.316.731 1.769s1.078.731 1.769.731zM20 15.59c-1.331 0-2.332.406-2.917.968-1.115-.917-2.878-1.558-5.083-1.558-2.266 0-3.995.648-5.092 1.564-.596-.565-1.608-.974-2.908-.974-2.188 0-3.5 1.09-3.5 2.182 0 .545 1.312 1.092 3.5 1.092.604 0 1.146-.051 1.623-.133l-.04.27c0 1 2.406 2 6.417 2 3.762 0 6.417-1 6.417-2l-.02-.255c.463.073.995.118 1.603.118 2.051 0 3.5-.547 3.5-1.092 0-1.092-1.373-2.182-3.5-2.182zM4 15c.69 0 1.315-.279 1.768-.732.453-.453.732-1.078.732-1.768 0-.689-.279-1.314-.732-1.768-.453-.452-1.078-.732-1.768-.732-.691 0-1.316.28-1.769.732-.452.454-.731 1.079-.731 1.768 0 .69.279 1.315.731 1.768.453.453 1.078.732 1.769.732z"></path></svg>Group Result</a></li>
                        <li><a href="/cgpa-calculator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM440.2 765h-50.8c-2.2 0-4.5-1.1-5.9-2.9L348 718.6l-35.5 43.5a7.38 7.38 0 0 1-5.9 2.9h-50.8c-6.6 0-10.2-7.9-5.8-13.1l62.7-76.8-61.2-74.9c-4.3-5.2-.7-13.1 5.9-13.1h50.9c2.2 0 4.5 1.1 5.9 2.9l34 41.6 34-41.6c1.5-1.9 3.6-2.9 5.9-2.9h50.8c6.6 0 10.2 7.9 5.9 13.1L383.5 675l62.7 76.8c4.2 5.3.6 13.2-6 13.2zm7.8-382c0 2.2-1.4 4-3.2 4H376v68.7c0 1.9-1.8 3.3-4 3.3h-48c-2.2 0-4-1.4-4-3.2V387h-68.8c-1.8 0-3.2-1.8-3.2-4v-48c0-2.2 1.4-4 3.2-4H320v-68.8c0-1.8 1.8-3.2 4-3.2h48c2.2 0 4 1.4 4 3.2V331h68.7c1.9 0 3.3 1.8 3.3 4v48zm328 369c0 2.2-1.4 4-3.2 4H579.2c-1.8 0-3.2-1.8-3.2-4v-48c0-2.2 1.4-4 3.2-4h193.5c1.9 0 3.3 1.8 3.3 4v48zm0-104c0 2.2-1.4 4-3.2 4H579.2c-1.8 0-3.2-1.8-3.2-4v-48c0-2.2 1.4-4 3.2-4h193.5c1.9 0 3.3 1.8 3.3 4v48zm0-265c0 2.2-1.4 4-3.2 4H579.2c-1.8 0-3.2-1.8-3.2-4v-48c0-2.2 1.4-4 3.2-4h193.5c1.9 0 3.3 1.8 3.3 4v48z"></path></svg>CGPA Calculator</a></li>
                        <li><a href="/booklists"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"></path></svg>Booklists</a></li>
                        <li><a href="/about"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0ZM-7-4a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM9 9a.75.75 0 0 0 0 1.5h.253a.25.25 0 0 1 .244.304l-.459 2.066A1.75 1.75 0 0 0 10.747 15H11a.75.75 0 0 0 0-1.5h-.253a.25.25 0 0 1-.244-.304l.459-2.066A1.75 1.75 0 0 0 9.253 9H9Z" clip-rule="evenodd"></path></svg>About</a></li>
                        <li><a href="mailto:mujahidulhasan2@gmail.com"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M424 80H88a56.06 56.06 0 0 0-56 56v240a56.06 56.06 0 0 0 56 56h336a56.06 56.06 0 0 0 56-56V136a56.06 56.06 0 0 0-56-56zm-14.18 92.63-144 112a16 16 0 0 1-19.64 0l-144-112a16 16 0 1 1 19.64-25.26L256 251.73l134.18-104.36a16 16 0 0 1 19.64 25.26z"></path></svg>Contact</a></li>
                    </ul>
                </div>
            </div>
             </div>
    </div>
    
    <script>
        // --- HELPER FUNCTION TO GET SELECTED VALUE ---
        function getSelectedOptionValue(elementId) {
             const selectedElement = document.getElementById(elementId);
             if (selectedElement) {
                // Get the text content from the selected span in the custom dropdown
                return selectedElement.textContent.trim().toUpperCase();
             }
             return null;
        }

        // --- GRADING SCALE HELPER (Based on your new design's color variants) ---
        function getGradeClassAndText(gpa) {
            const gpaValue = String(gpa).toLowerCase();
            const gpaNumber = parseFloat(gpa);

            if (gpaValue === 'ref') {
                return { class: 'grade-ref', text: 'Referred (Ref)', status: 'Referred' };
            } else if (gpaNumber >= 3.60) {
                return { class: 'grade-aplus', text: gpaNumber.toFixed(2) + ' (A+)', status: 'Passed' };
            } else if (gpaNumber >= 3.20) {
                return { class: 'grade-a', text: gpaNumber.toFixed(2) + ' (A)', status: 'Passed' };
            } else if (gpaNumber >= 2.80) {
                return { class: 'grade-aminus', text: gpaNumber.toFixed(2) + ' (A-)', status: 'Passed' };
            } else if (gpaNumber >= 2.00) {
                 return { class: 'grade-a', text: gpaNumber.toFixed(2) + ' (B/C)', status: 'Passed' }; // Use 'A' color for general pass
            } else {
                 return { class: 'grade-ref', text: gpaNumber.toFixed(2) + ' (Failed)', status: 'Referred' };
            }
        }
        
        // Function to handle the screenshot (Requires html2canvas)
        function takeScreenshot() {
          const popup = document.getElementById("popup-main-content"); // Target the main popup div
          // Temporarily hide the buttons for a clean screenshot
          const ssBtn = document.querySelector('#popup-main-content .screenshot-btn');
          const closeBtn = document.querySelector('#popup-main-content .close-btn');
          ssBtn.style.display = 'none';
          closeBtn.style.display = 'none';
          
          html2canvas(popup, { 
              scale: 3,
              backgroundColor: null 
            }).then(canvas => {
            const link = document.createElement("a");
            link.download = "Result_Roll_" + document.getElementById('roll-number').value.trim() + ".png";
            link.href = canvas.toDataURL("image/png");
            link.click();
            
            // Show buttons again
            ssBtn.style.display = 'flex';
            closeBtn.style.display = 'block';
          });
        }
        
        // Results data store
        let ALL_RESULTS = {};

        async function loadResultsJSON() {
            try {
                const response = await fetch('results.json', { cache: "no-store" });
                if (!response.ok) {
                    throw new Error(`HTTP Error! Status: ${response.status}.`);
                }
                const data = await response.json();
                ALL_RESULTS = data.data || {}; // Assuming results.json has a top-level 'data' key
            } catch (error) {
                console.error('Error fetching results.json:', error);
                ALL_RESULTS = {}; // Clear if loading fails
            }
        }


        // --- ASYNCHRONOUS RESULT LOOKUP LOGIC ---
        async function getResults() {
            const rollNumber = document.getElementById('roll-number').value.trim();
            const exam = getSelectedOptionValue('selected-exam');
            const regulation = getSelectedOptionValue('selected-regulation');

            // Modal elements
            const resultModal = document.getElementById('result_modal');
            const popupContainer = document.getElementById('popup-container');

            // Close any open modal before proceeding
            resultModal.close();

            // 1. Clear previous results
            popupContainer.innerHTML = '';
            
            // 2. Basic Input Validation
            if (!rollNumber || rollNumber.length !== 6 || isNaN(rollNumber)) {
                popupContainer.innerHTML = `
                    <div class="popup text-center dark:text-white text-gray-900">
                        <h2 class="text-xl font-bold mb-2">Validation Error</h2>
                        <p class="text-red-500">Please enter a valid 6-digit Roll Number.</p>
                        <form method="dialog"><button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button></form>
                    </div>
                `;
                resultModal.showModal();
                return;
            }

            // 3. Ensure data is loaded
            if (Object.keys(ALL_RESULTS).length === 0) await loadResultsJSON();
            
            // 4. Data Lookup & Filtering
            const studentData = ALL_RESULTS[rollNumber];

            if (!studentData) {
                popupContainer.innerHTML = `
                    <div class="popup text-center dark:text-white text-gray-900">
                        <h2 class="text-xl font-bold mb-2">Result Not Found</h2>
                        <p class="text-red-500">No result found for Roll Number ${rollNumber} with the selected criteria.</p>
                        <form method="dialog"><button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button></form>
                    </div>
                `;
                resultModal.showModal();
                return;
            }

            // 5. Final Criteria Check
            const dataExam = (studentData.exam || '').trim().toUpperCase();
            const dataRegulation = (studentData.regulation || '').trim().toUpperCase();

            if (dataExam !== exam || dataRegulation !== regulation) {
                 popupContainer.innerHTML = `
                    <div class="popup text-center dark:text-white text-gray-900">
                        <h2 class="text-xl font-bold mb-2">Criteria Mismatch</h2>
                        <p class="text-red-500">Result found but criteria mismatched:</p>
                        <p class="mt-2"><strong>Found:</strong> ${dataExam} (${dataRegulation})</p>
                        <p><strong>Selected:</strong> ${exam} (${regulation})</p>
                        <form method="dialog"><button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button></form>
                    </div>
                `;
                resultModal.showModal();
                return;
            }

            // 6. Display Result (New Stylish Popup)
            let resultsHTML = '';
            let referredSubjectsHTML = '';
            const allResults = studentData.results || {};
            const referred = studentData.referred_subjects || [];

            // Map gpa keys to user-friendly names
            const gpaMap = { 
                'gpa1': '1st Semester', 'gpa2': '2nd Semester', 
                'gpa3': '3rd Semester', 'gpa4': '4th Semester',
                'gpa5': '5th Semester', 'gpa6': '6th Semester',
                'gpa7': '7th Semester', 'gpa8': '8th Semester'
            };
            
            // Sort keys numerically (gpa1, gpa2, ...) and reverse for latest first
            const sortedGpaKeys = Object.keys(allResults).filter(key => key.startsWith('gpa')).sort((a, b) => {
                return parseInt(b.substring(3)) - parseInt(a.substring(3)); // Reverse sort
            });


            sortedGpaKeys.forEach(key => {
                const semesterName = gpaMap[key];
                const gpaValue = allResults[key];
                const publishedDate = studentData.dates?.[key] || 'N/A'; // Use specific date if available
                
                if (gpaValue !== undefined && semesterName) {
                    const { class: gradeClass, text: displayText, status: statusText } = getGradeClassAndText(gpaValue);

                    resultsHTML += `
                        <div class="result-card">
                          <div class="semester-header">
                            <span>${semesterName}</span>
                            <div class="status-${statusText.toLowerCase()}">${statusText}</div>
                            <div class="date">${publishedDate}</div>
                          </div>
                          <div class="cgpa ${gradeClass}">CGPA: ${displayText}</div>
                        </div>
                    `;
                }
            });

            // Add Referred Subjects section if any
            const validReferred = referred.filter(s => s && s.length > 2);
            if (validReferred.length > 0) {
                 referredSubjectsHTML = `
                     <div class="mt-6 p-4 rounded-lg bg-red-800/20 border border-red-500/50">
                         <h3 class="text-lg font-bold text-red-400 mb-2">Referred Subjects (${validReferred.length})</h3>
                         <ul class="list-disc list-inside space-y-1 ml-4 text-red-300">
                             ${validReferred.map(s => `<li>${s}</li>`).join('')}
                         </ul>
                     </div>
                 `;
            }

            // Final Result Card Structure
            popupContainer.innerHTML = `
                <div class="popup" id="popup-main-content">
                  <button class="screenshot-btn" onclick="takeScreenshot()">📸</button>
                  <form method="dialog"><button class="close-btn">&times;</button></form>

                  <div class="popup-header">
                    <h2>Roll: ${rollNumber}</h2>
                    <p>${studentData.exam || 'N/A'} (${studentData.regulation || 'N/A'})</p>
                    <p>${studentData.institute_name || 'Institute N/A'}</p>
                  </div>

                  ${resultsHTML}

                  ${referredSubjectsHTML}
                </div>
            `;
            
            // Show the final modal
            resultModal.showModal();
        }

        // --- THEME TOGGLE JS (EXISTING CODE) ---
        const storedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', storedTheme);
        document.documentElement.className = storedTheme;
        document.getElementById('main-content-wrapper').setAttribute('data-theme', storedTheme);

        function updateIcons(theme) {
            const moonIcon = document.getElementById('moon-icon');
            const sunIcon = document.getElementById('sun-icon');
            const themeToggle = document.getElementById('theme-toggle');

            if (theme === 'dark') {
                moonIcon.style.display = 'block';
                sunIcon.style.display = 'none';
                themeToggle.classList.add('text-white');
                themeToggle.classList.remove('text-gray-900');
            } else {
                moonIcon.style.display = 'none';
                sunIcon.style.display = 'block';
                themeToggle.classList.add('text-gray-900');
                themeToggle.classList.remove('text-white');
            }
        }
        
        updateIcons(storedTheme);

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            document.documentElement.className = newTheme;
            document.getElementById('main-content-wrapper').setAttribute('data-theme', newTheme);
            
            localStorage.setItem('theme', newTheme);
            
            updateIcons(newTheme);
        }
        
        // --- CUSTOM DROPDOWN JS (EXISTING CODE) ---
        function toggleDropdown(header) {
            // Closes all other open dropdowns before opening the new one
            document.querySelectorAll('.card.open').forEach(menu => {
                 if (menu !== header.nextElementSibling) {
                    menu.classList.remove('open');
                 }
            });
            const menu = header.nextElementSibling;
            menu.classList.toggle('open');
            // Give header a focus style when open
            header.classList.toggle('ring-2', menu.classList.contains('open'));
            header.classList.toggle('ring-offset-2', menu.classList.contains('open'));
            header.classList.toggle('ring-blue-500', menu.classList.contains('open'));
        }

        // Updates selected text and closes the dropdown
        function selectOption(radioId, value, selectedElementId) {
            const radio = document.getElementById(radioId);
            const menu = radio.closest('.card');
            const selectedText = document.getElementById(selectedElementId);
            const header = radio.closest('.custom-dropdown-container').querySelector('.custom-dropdown-header');


            selectedText.textContent = value;
            radio.checked = true;
            
            // Close menu and remove focus styling
            menu.classList.remove('open');
            header.classList.remove('ring-2', 'ring-offset-2', 'ring-blue-500');

            event.stopPropagation();
        }

        document.addEventListener('click', function(event) {
            const dropdownContainers = document.querySelectorAll('.custom-dropdown-container');
            dropdownContainers.forEach(container => {
                const menu = container.querySelector('.card');
                const header = container.querySelector('.custom-dropdown-header');
                
                // If a dropdown is open AND the click target is outside the dropdown container, close it.
                if (menu && menu.classList.contains('open') && !container.contains(event.target)) {
                    menu.classList.remove('open');
                    header.classList.remove('ring-2', 'ring-offset-2', 'ring-blue-500');
                }
            });
        });

        // Initialize data load
        document.addEventListener('DOMContentLoaded', loadResultsJSON);
    </script>

</body>
</html>
